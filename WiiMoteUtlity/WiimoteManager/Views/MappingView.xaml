<UserControl x:Class="WiimoteManager.Views.MappingView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" 
             Background="#1E1E1E" Height="450" Width="800">
    <Grid Margin="20">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="250"/> <!-- List of mappings -->
            <ColumnDefinition Width="*"/>   <!-- Controller Visual -->
        </Grid.ColumnDefinitions>

        <!-- Mapping List -->
        <Border Grid.Column="0" Background="#252526" BorderBrush="#3E3E42" BorderThickness="1" CornerRadius="4">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <TextBlock Text="Button Mappings" FontWeight="Bold" Foreground="White" Margin="10" FontSize="14"/>
                
                <ListBox Grid.Row="1" 
                         ItemsSource="{Binding Mappings}" 
                         SelectedItem="{Binding SelectedMapping}"
                         Background="Transparent" 
                         BorderThickness="0"
                         Foreground="White">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Grid Margin="0,4">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="80"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="{Binding TargetName}" FontWeight="Bold" Foreground="#00CC44"/>
                                <TextBlock Grid.Column="1" Text=" -> " Foreground="Gray"/>
                                <TextBlock Grid.Column="2" Text="{Binding WiimoteButton}" Foreground="White"/>
                            </Grid>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>

                <StackPanel Grid.Row="2" Margin="10">
                    <TextBlock Text="{Binding StatusText}" Foreground="Yellow" TextWrapping="Wrap" Margin="0,0,0,10"/>
                    <Button Content="Map Selected" Command="{Binding StartListeningCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,0,5"/>
                    <Button Content="Clear Mapping" Command="{Binding ClearMappingCommand}" Style="{StaticResource DangerButton}"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Controller Visualization -->
        <Grid Grid.Column="1" Margin="20,0,0,0">
            <!-- XBOX Controller Vector Shape -->
            <Viewbox>
                <Canvas Width="600" Height="400">
                    <!-- Controller Body -->
                    <Path Fill="#DDDDDD" Stroke="#333333" StrokeThickness="2"
                          Data="M 150,100 C 100,100 50,150 50,250 C 50,350 120,400 180,350 L 220,300 L 380,300 L 420,350 C 480,400 550,350 550,250 C 550,150 500,100 450,100 Z"/>
                    
                    <!-- Left Stick -->
                    <Ellipse Canvas.Left="100" Canvas.Top="150" Width="60" Height="60" Fill="#333333" Stroke="Black"/>
                    <TextBlock Canvas.Left="115" Canvas.Top="170" Text="LS" Foreground="White"/>
                    
                    <!-- D-Pad -->
                    <Path Canvas.Left="180" Canvas.Top="220" Fill="#333333" Data="M 20,0 L 40,0 L 40,20 L 60,20 L 60,40 L 40,40 L 40,60 L 20,60 L 20,40 L 0,40 L 0,20 L 20,20 Z"/>
                    
                    <!-- Guide Button -->
                    <Ellipse Canvas.Left="275" Canvas.Top="150" Width="50" Height="50" Fill="#107C10"/>
                    
                    <!-- Right Stick -->
                    <Ellipse Canvas.Left="350" Canvas.Top="220" Width="60" Height="60" Fill="#333333" Stroke="Black"/>
                    <TextBlock Canvas.Left="365" Canvas.Top="240" Text="RS" Foreground="White"/>
                    
                    <!-- ABXY Buttons -->
                    <Ellipse Canvas.Left="450" Canvas.Top="150" Width="30" Height="30" Fill="#2A2A2A"/> <!-- Center reference for ABXY -->
                    
                    <!-- Y -->
                    <Ellipse Canvas.Left="450" Canvas.Top="120" Width="30" Height="30" Fill="#F2C409"/>
                    <TextBlock Canvas.Left="460" Canvas.Top="125" Text="Y" FontWeight="Bold"/>

                    <!-- X -->
                    <Ellipse Canvas.Left="420" Canvas.Top="150" Width="30" Height="30" Fill="#0078D7"/>
                    <TextBlock Canvas.Left="430" Canvas.Top="155" Text="X" Foreground="White" FontWeight="Bold"/>

                    <!-- B -->
                    <Ellipse Canvas.Left="480" Canvas.Top="150" Width="30" Height="30" Fill="#D93A00"/>
                    <TextBlock Canvas.Left="490" Canvas.Top="155" Text="B" Foreground="White" FontWeight="Bold"/>

                    <!-- A -->
                    <Ellipse Canvas.Left="450" Canvas.Top="180" Width="30" Height="30" Fill="#107C10"/>
                    <TextBlock Canvas.Left="460" Canvas.Top="185" Text="A" Foreground="White" FontWeight="Bold"/>
                    
                    <!-- Bumpers -->
                    <Rectangle Canvas.Left="100" Canvas.Top="80" Width="80" Height="30" RadiusX="5" RadiusY="5" Fill="#999999"/>
                    <TextBlock Canvas.Left="130" Canvas.Top="85" Text="LB"/>
                    
                    <Rectangle Canvas.Left="420" Canvas.Top="80" Width="80" Height="30" RadiusX="5" RadiusY="5" Fill="#999999"/>
                    <TextBlock Canvas.Left="450" Canvas.Top="85" Text="RB"/>
                    
                    <!-- Start/Back -->
                    <Ellipse Canvas.Left="240" Canvas.Top="160" Width="20" Height="20" Fill="#333333"/>
                    <TextBlock Canvas.Left="240" Canvas.Top="130" Text="Back" FontSize="10"/>
                    
                    <Ellipse Canvas.Left="340" Canvas.Top="160" Width="20" Height="20" Fill="#333333"/>
                    <TextBlock Canvas.Left="340" Canvas.Top="130" Text="Start" FontSize="10"/>

                </Canvas>
            </Viewbox>
        </Grid>
    </Grid>
</UserControl>
<Window x:Class="WiimoteManager.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WiimoteManager"
        Title="Wiimote Manager Pro"
        MinWidth="1000"
        MinHeight="650"
        Background="#1E1E1E"
        Foreground="#FFFFFF"
        WindowStartupLocation="CenterScreen"
        SizeToContent="Manual">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" MinHeight="70"/>
            <RowDefinition Height="Auto" MinHeight="55"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto" MinHeight="40"/>
        </Grid.RowDefinitions>

        <!-- Header Panel -->
        <Border Grid.Row="0" Background="#2D2D2D" BorderBrush="#3D3D3D" BorderThickness="0,0,0,1">
            <StackPanel Margin="20,15" VerticalAlignment="Center">
                <TextBlock FontSize="28" FontWeight="Bold" Foreground="#00AA44"
                           TextTrimming="CharacterEllipsis" TextWrapping="NoWrap">
                    ðŸŽ® Wiimote Manager Pro
                </TextBlock>
                <TextBlock FontSize="12" Foreground="#AAAAAA" Margin="0,5,0,0"
                           TextTrimming="CharacterEllipsis" TextWrapping="NoWrap"
                           MaxWidth="800">
                    Manage Nintendo Wiimote devices on Windows 11
                </TextBlock>
            </StackPanel>
        </Border>

        <!-- Control Panel -->
        <Border Grid.Row="1" Background="#252525" BorderBrush="#3D3D3D" BorderThickness="0,0,0,1">
            <Grid Margin="20,0" VerticalAlignment="Center">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Button Panel -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <!-- Scan Button -->
                    <Button x:Name="ScanButton"
                            Command="{Binding ScanDevicesCommand}"
                            Style="{StaticResource PrimaryButton}"
                            Padding="20,12"
                            Margin="0,10,10,10"
                            ToolTip="Connect to paired Wiimotes">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <TextBlock Text="ðŸŽ®" FontSize="16" Margin="0,0,8,0" VerticalAlignment="Center"/>
                            <TextBlock Text="Connect Wiimotes" FontSize="13" FontWeight="Bold" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>

                    <!-- Disconnect All Button -->
                    <Button x:Name="DisconnectButton"
                            Command="{Binding DisconnectAllCommand}"
                            Style="{StaticResource DangerButton}"
                            Padding="20,12"
                            Margin="0,10,10,10"
                            ToolTip="Disconnect all Wiimotes">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <TextBlock Text="â¹ï¸" FontSize="16" Margin="0,0,8,0" VerticalAlignment="Center"/>
                            <TextBlock Text="Disconnect All" FontSize="13" FontWeight="Bold" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>

                    <!-- Clear Button -->
                    <Button x:Name="ClearButton"
                            Command="{Binding ClearDiscoveredDevicesCommand}"
                            Style="{StaticResource SecondaryButton}"
                            Padding="20,12"
                            Margin="0,10,10,10"
                            ToolTip="Clear device list">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <TextBlock Text="ðŸ—‘ï¸" FontSize="16" Margin="0,0,8,0" VerticalAlignment="Center"/>
                            <TextBlock Text="Clear List" FontSize="13" FontWeight="Bold" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                </StackPanel>

                <!-- Status Indicators -->
                <Border Grid.Column="1" BorderBrush="#3D3D3D" BorderThickness="1,0,0,0" Padding="20,0,0,0">
                    <Grid VerticalAlignment="Center">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- Connected Count -->
                        <TextBlock Grid.Column="0" FontSize="13" TextWrapping="NoWrap">
                            <Run FontWeight="Bold" Foreground="#00AA44">Connected:</Run>
                            <Run Text="{Binding ConnectedWiimotes.Count, Mode=OneWay}" FontWeight="Bold"/>
                        </TextBlock>

                        <!-- Discovered Count -->
                        <TextBlock Grid.Column="2" FontSize="13" TextWrapping="NoWrap">
                            <Run FontWeight="Bold" Foreground="#FFAA00">New:</Run>
                            <Run Text="{Binding DiscoveredDeviceCount, Mode=OneWay}" FontWeight="Bold"/>
                        </TextBlock>
                    </Grid>
                </Border>
            </Grid>
        </Border>

        <!-- Main Content Area with Tabs -->
        <Grid Grid.Row="2" Background="#1E1E1E">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*" MinWidth="400"/>
                <ColumnDefinition Width="1*" MinWidth="250" MaxWidth="350"/>
            </Grid.ColumnDefinitions>

            <!-- Devices Area -->
            <Grid Grid.Column="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" MinHeight="35"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Status Bar -->
                <Border Grid.Row="0" Background="#2D2D2D" BorderBrush="#3D3D3D" BorderThickness="0,0,0,1" Padding="20,8">
                    <TextBlock VerticalAlignment="Center" Foreground="#FFCC00" 
                               Text="{Binding StatusMessage}" FontSize="12"
                               TextTrimming="CharacterEllipsis" TextWrapping="NoWrap"/>
                </Border>

                <!-- Devices List -->
                <ScrollViewer Grid.Row="1" Margin="20" Background="Transparent">
                    <ItemsControl ItemsSource="{Binding ConnectedWiimotes}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel Orientation="Horizontal" Margin="0"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <local:WiimoteCard/>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>

                <!-- Empty State -->
                <StackPanel Grid.Row="1" VerticalAlignment="Center" HorizontalAlignment="Center"
                           Visibility="{Binding ConnectedWiimotes.Count, Converter={StaticResource EmptyCollectionConverter}, Mode=OneWay}"
                           Margin="20" MaxWidth="500">
                    <TextBlock FontSize="48" Foreground="#555555" TextAlignment="Center">ðŸŽ®</TextBlock>
                    <TextBlock FontSize="18" Foreground="#666666" TextAlignment="Center" Margin="0,10,0,0"
                               TextWrapping="Wrap">
                        No Wiimotes connected
                    </TextBlock>
                    <TextBlock FontSize="13" Foreground="#777777" TextAlignment="Center" Margin="0,15,0,0"
                               TextWrapping="Wrap" LineHeight="20">
                        <Bold>To connect a Wiimote:</Bold><LineBreak/>
                        1. Open Control Panel â†’ Devices and Printers<LineBreak/>
                        2. Click "Add a device"<LineBreak/>
                        3. Press RED SYNC button on Wiimote<LineBreak/>
                        4. Select "Nintendo RVL-CNT-01" and skip PIN<LineBreak/>
                        5. Click "Connect Wiimotes" button above
                    </TextBlock>
                </StackPanel>
            </Grid>

            <!-- Right Panel: Log/Info -->
            <Border Grid.Column="1" Background="#252525" BorderBrush="#3D3D3D" BorderThickness="1,0,0,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" MinHeight="40"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Log Tab Header -->
                    <Border Grid.Row="0" Background="#2D2D2D" BorderBrush="#3D3D3D" BorderThickness="0,0,0,1">
                        <TextBlock Margin="15,10" FontSize="13" FontWeight="Bold" Foreground="#00AA44"
                                   TextTrimming="CharacterEllipsis">
                            ðŸ“‹ Application Log
                        </TextBlock>
                    </Border>

                    <!-- Log Content with ScrollViewer -->
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="0"
                                  x:Name="LogScrollViewer">
                        <TextBox Text="{Binding DebugLog, Mode=OneWay}" 
                                 IsReadOnly="True"
                                 Background="#1A1A1A"
                                 Foreground="#00FF00"
                                 BorderThickness="0"
                                 FontFamily="Consolas"
                                 FontSize="10"
                                 TextWrapping="Wrap"
                                 Padding="15"
                                 VerticalScrollBarVisibility="Auto"
                                 AcceptsReturn="True"/>
                    </ScrollViewer>
                </Grid>
            </Border>
        </Grid>

        <!-- Footer -->
        <Border Grid.Row="3" Background="#252525" BorderBrush="#3D3D3D" BorderThickness="0,1,0,0">
            <TextBlock Margin="20,12" VerticalAlignment="Center" FontSize="11" Foreground="#666666"
                       TextTrimming="CharacterEllipsis" TextWrapping="NoWrap">
                Windows 11 Bluetooth Manager â€¢ Supports RVL-001 &amp; RVL-CNT-01 â€¢ Extensions: Nunchuk, Classic
            </TextBlock>
        </Border>
    </Grid>
</Window>
